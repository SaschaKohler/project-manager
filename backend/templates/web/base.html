<!doctype html>
{% load i18n %}
{% get_current_language as CURRENT_LANGUAGE %}
<html lang="{{ CURRENT_LANGUAGE }}">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}Project Manager{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
      :root {
        /* Light theme variables */
        --bg-primary: rgb(255, 255, 255);
        --bg-secondary: rgb(249, 250, 251);
        --bg-tertiary: rgb(243, 244, 246);
        --bg-sidebar: rgb(255, 255, 255);
        --bg-header: rgb(255, 255, 255);
        --text-primary: rgb(17, 24, 39);
        --text-secondary: rgb(107, 114, 128);
        --text-muted: rgb(156, 163, 175);
        --border-color: rgb(229, 231, 235);
        --border-hover: rgb(209, 213, 219);
        --accent-bg: rgba(99, 102, 241, 0.1);
        --accent-border: rgba(99, 102, 241, 0.2);
        --gradient-1: radial-gradient(1200px 600px at 15% -10%, rgba(99, 102, 241, 0.08), transparent 55%);
        --gradient-2: radial-gradient(900px 500px at 85% 0%, rgba(16, 185, 129, 0.05), transparent 60%);
        --gradient-bg: linear-gradient(to bottom, rgb(255, 255, 255), rgb(249, 250, 251));
        --selection-bg: rgba(99, 102, 241, 0.2);
        --selection-text: rgb(17, 24, 39);
        --scrollbar-track: rgb(243, 244, 246);
        --scrollbar-thumb: rgb(156, 163, 175);
        --scrollbar-thumb-hover: rgb(107, 114, 128);
      }

      [data-theme="dark"] {
        /* Dark theme variables */
        --bg-primary: rgb(9, 9, 11);
        --bg-secondary: rgb(24, 24, 27);
        --bg-tertiary: rgb(39, 39, 42);
        --bg-sidebar: rgb(15, 15, 17);
        --bg-header: rgb(15, 15, 17);
        --text-primary: rgb(244, 244, 245);
        --text-secondary: rgb(161, 161, 170);
        --text-muted: rgb(113, 113, 122);
        --border-color: rgba(63, 63, 70, 0.7);
        --border-hover: rgba(82, 82, 91, 0.7);
        --accent-bg: rgba(99, 102, 241, 0.15);
        --accent-border: rgba(99, 102, 241, 0.35);
        --gradient-1: radial-gradient(1200px 600px at 15% -10%, rgba(99, 102, 241, 0.18), transparent 55%);
        --gradient-2: radial-gradient(900px 500px at 85% 0%, rgba(16, 185, 129, 0.10), transparent 60%);
        --gradient-bg: linear-gradient(to bottom, rgb(9, 9, 11), rgb(24, 24, 27));
        --selection-bg: rgba(99, 102, 241, 0.35);
        --selection-text: rgb(250, 250, 250);
        --scrollbar-track: rgb(24, 24, 27);
        --scrollbar-thumb: rgb(113, 113, 122);
        --scrollbar-thumb-hover: rgb(161, 161, 170);
      }

      * {
        transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
      }

      body {
        background: var(--gradient-1), var(--gradient-2), var(--gradient-bg);
        color: var(--text-primary);
      }

      ::selection {
        background: var(--selection-bg);
        color: var(--selection-text);
      }

      /* Custom scrollbar styles for better cross-browser compatibility */
      .scrollbar-thin {
        scrollbar-width: thin;
        scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-track);
      }

      .scrollbar-thin::-webkit-scrollbar {
        width: 6px;
      }

      .scrollbar-thin::-webkit-scrollbar-track {
        background: var(--scrollbar-track);
        border-radius: 3px;
      }

      .scrollbar-thin::-webkit-scrollbar-thumb {
        background: var(--scrollbar-thumb);
        border-radius: 3px;
      }

      .scrollbar-thin::-webkit-scrollbar-thumb:hover {
        background: var(--scrollbar-thumb-hover);
      }

      /* Theme-aware utility classes */
      .bg-sidebar {
        background-color: var(--bg-sidebar);
      }

      .bg-header {
        background-color: var(--bg-header);
      }

      .bg-secondary {
        background-color: var(--bg-secondary);
      }

      .bg-tertiary {
        background-color: var(--bg-tertiary);
      }

      .text-secondary {
        color: var(--text-secondary);
      }

      .text-muted {
        color: var(--text-muted);
      }

      .border-theme {
        border-color: var(--border-color);
      }

      .border-theme-hover {
        border-color: var(--border-hover);
      }

      .bg-accent {
        background-color: var(--accent-bg);
      }

      .border-accent {
        border-color: var(--accent-border);
      }
    </style>
    <script>
      function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
      }
      document.addEventListener('htmx:configRequest', (event) => {
        const token = getCookie('csrftoken');
        if (token) {
          event.detail.headers['X-CSRFToken'] = token;
        }
      });

      // Theme management
      function getStoredTheme() {
        return localStorage.getItem('theme') || 'dark';
      }

      function setStoredTheme(theme) {
        localStorage.setItem('theme', theme);
      }

      function applyTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        setStoredTheme(theme);
      }

      function toggleTheme() {
        const currentTheme = getStoredTheme();
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        applyTheme(newTheme);
      }

      // Initialize theme on page load
      document.addEventListener('DOMContentLoaded', () => {
        const theme = getStoredTheme();
        applyTheme(theme);
      });

      // Make toggleTheme available globally
      window.toggleTheme = toggleTheme;
    </script>
  </head>
  <body class="min-h-screen antialiased">
    <div class="min-h-screen">
      {% block body %}{% endblock %}
    </div>
  </body>
</html>
